import{a as T,j as e,R as W,r as d}from"./client-DEd7WeES.js";const w=void 0,R={async getUserResume(t){try{const n=await fetch(`${w}/api/resumes`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!n.ok)throw new Error(`Failed to fetch resumes: ${n.status}`);const p=(await n.json()).resumes;if(!p||p.length===0)return null;const g=p[0].id,l=await fetch(`${w}/api/resume/${g}`,{method:"GET",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"}});if(!l.ok)throw new Error(`Failed to fetch resume: ${l.status}`);return await l.json()}catch(n){throw n}},async updateResume(t,n,m,p,g){const l=await fetch(`${w}/api/resume/upload`,{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({file_name:p,parsed_data:m,raw_text:g})});if(!l.ok){const S=await l.json();throw new Error(S.error||"Failed to update resume")}}};async function z(){try{return(await chrome.storage.local.get(["auth_token"])).auth_token||null}catch(t){return console.error("Error getting auth token:",t),null}}const N=()=>{const[t,n]=d.useState(null),[m,p]=d.useState(""),[g,l]=d.useState(""),[S,k]=d.useState(""),[D,B]=d.useState(!0),[b,C]=d.useState(!1),[f,c]=d.useState(null),[E,x]=d.useState(!1);d.useEffect(()=>{(async()=>{try{const r=await z();if(!r){c("Not authenticated. Please log in."),B(!1);return}const i=await R.getUserResume(r);i?(p(i.id),l(i.file_name),k(i.raw_text),n(i.parsed_data)):c("No resume found. Please upload a resume first.")}catch(r){c(r instanceof Error?r.message:"Failed to load resume")}finally{B(!1)}})()},[]);const a=(o,r)=>{t&&(n({...t,[o]:r}),x(!1))},y=(o,r,i)=>{if(!t)return;const s=[...t[o]];if(s[r]=i,o==="experience"){const h=[...t.experienceDetails];h[r]&&(h[r]={...h[r],text:i}),n({...t,experience:s,experienceDetails:h})}else n({...t,[o]:s});x(!1)},j=o=>{t&&(n(o==="experience"?{...t,experience:[...t.experience,""],experienceDetails:[...t.experienceDetails,{text:"",startDate:"",endDate:"",startMonth:"",startYear:"",endMonth:"",endYear:""}]}:{...t,[o]:[...t[o],""]}),x(!1))},v=(o,r)=>{if(t){if(o==="experience")n({...t,experience:t.experience.filter((i,s)=>s!==r),experienceDetails:t.experienceDetails.filter((i,s)=>s!==r)});else{const i=t[o].filter((s,h)=>h!==r);n({...t,[o]:i})}x(!1)}},u=(o,r,i)=>{if(!t)return;const s=[...t.experienceDetails];s[o]={...s[o],[r]:i},n({...t,experienceDetails:s}),x(!1)},A=async()=>{if(t){C(!0),c(null),x(!1);try{const o=await z();if(!o){c("Not authenticated");return}await R.updateResume(o,m,t,g,S),x(!0)}catch(o){c(o instanceof Error?o.message:"Failed to save resume")}finally{C(!1)}}};return D?e.jsx("div",{style:{padding:"20px",textAlign:"center"},children:e.jsx("p",{children:"Loading resume..."})}):f&&!t?e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h2",{style:{color:"#dc2626",marginBottom:"10px"},children:"Error"}),e.jsx("p",{children:f})]}):t?e.jsxs("div",{style:{padding:"20px",fontFamily:"Arial, sans-serif",maxWidth:"800px"},children:[e.jsx("h1",{style:{marginBottom:"20px",fontSize:"24px"},children:"Edit Resume"}),f&&e.jsx("div",{style:{padding:"10px",backgroundColor:"#fee2e2",border:"1px solid #dc2626",borderRadius:"4px",marginBottom:"20px",color:"#dc2626"},children:f}),E&&e.jsx("div",{style:{padding:"10px",backgroundColor:"#dcfce7",border:"1px solid #16a34a",borderRadius:"4px",marginBottom:"20px",color:"#16a34a"},children:"Resume saved successfully!"}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Personal Information"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"First Name"}),e.jsx("input",{type:"text",value:t.firstName,onChange:o=>a("firstName",o.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Last Name"}),e.jsx("input",{type:"text",value:t.lastName,onChange:o=>a("lastName",o.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Email"}),e.jsx("input",{type:"email",value:t.email,onChange:o=>a("email",o.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Phone"}),e.jsx("input",{type:"tel",value:t.phone,onChange:o=>a("phone",o.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Country Code"}),e.jsx("input",{type:"text",value:t.countryCode,onChange:o=>a("countryCode",o.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Phone Number"}),e.jsx("input",{type:"tel",value:t.phoneNumber,onChange:o=>a("phoneNumber",o.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]})]})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Location"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Street Address"}),e.jsx("input",{type:"text",value:t.streetAddress,onChange:o=>a("streetAddress",o.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"City"}),e.jsx("input",{type:"text",value:t.city,onChange:o=>a("city",o.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Country"}),e.jsx("input",{type:"text",value:t.country,onChange:o=>a("country",o.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Full Location"}),e.jsx("input",{type:"text",value:t.location,onChange:o=>a("location",o.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]})]})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Professional Summary"}),e.jsx("textarea",{value:t.professionalSummary,onChange:o=>a("professionalSummary",o.target.value),rows:4,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",fontFamily:"Arial, sans-serif"}})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Skills"}),t.skills.map((o,r)=>e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[e.jsx("input",{type:"text",value:o,onChange:i=>y("skills",r,i.target.value),style:{flex:1,padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}}),e.jsx("button",{onClick:()=>v("skills",r),style:{padding:"8px 12px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"Remove"})]},r)),e.jsx("button",{onClick:()=>j("skills"),style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",marginTop:"10px"},children:"Add Skill"})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Experience"}),t.experience.map((o,r)=>e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#f9fafb",borderRadius:"4px"},children:[e.jsx("textarea",{value:o,onChange:i=>y("experience",r,i.target.value),rows:3,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",fontFamily:"Arial, sans-serif",marginBottom:"10px"}}),t.experienceDetails[r]&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"10px",marginBottom:"10px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Start Month"}),e.jsx("input",{type:"text",value:t.experienceDetails[r].startMonth,onChange:i=>u(r,"startMonth",i.target.value),style:{width:"100%",padding:"6px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Start Year"}),e.jsx("input",{type:"text",value:t.experienceDetails[r].startYear,onChange:i=>u(r,"startYear",i.target.value),style:{width:"100%",padding:"6px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Start Date"}),e.jsx("input",{type:"text",value:t.experienceDetails[r].startDate,onChange:i=>u(r,"startDate",i.target.value),style:{width:"100%",padding:"6px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"End Month"}),e.jsx("input",{type:"text",value:t.experienceDetails[r].endMonth,onChange:i=>u(r,"endMonth",i.target.value),style:{width:"100%",padding:"6px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"End Year"}),e.jsx("input",{type:"text",value:t.experienceDetails[r].endYear,onChange:i=>u(r,"endYear",i.target.value),style:{width:"100%",padding:"6px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"End Date"}),e.jsx("input",{type:"text",value:t.experienceDetails[r].endDate,onChange:i=>u(r,"endDate",i.target.value),style:{width:"100%",padding:"6px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]})]}),e.jsx("button",{onClick:()=>v("experience",r),style:{padding:"6px 12px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Remove Experience"})]},r)),e.jsx("button",{onClick:()=>j("experience"),style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",marginTop:"10px"},children:"Add Experience"})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Projects"}),t.projects.map((o,r)=>e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("textarea",{value:o,onChange:i=>y("projects",r,i.target.value),rows:3,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",fontFamily:"Arial, sans-serif",marginBottom:"5px"}}),e.jsx("button",{onClick:()=>v("projects",r),style:{padding:"6px 12px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Remove Project"})]},r)),e.jsx("button",{onClick:()=>j("projects"),style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",marginTop:"10px"},children:"Add Project"})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Education"}),t.education.map((o,r)=>e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("textarea",{value:o,onChange:i=>y("education",r,i.target.value),rows:2,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",fontFamily:"Arial, sans-serif",marginBottom:"5px"}}),e.jsx("button",{onClick:()=>v("education",r),style:{padding:"6px 12px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Remove Education"})]},r)),e.jsx("button",{onClick:()=>j("education"),style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",marginTop:"10px"},children:"Add Education"})]}),e.jsx("div",{style:{position:"sticky",bottom:"0",backgroundColor:"white",padding:"20px 0",borderTop:"2px solid #e5e7eb",marginTop:"20px"},children:e.jsx("button",{onClick:A,disabled:b,style:{width:"100%",padding:"12px",backgroundColor:b?"#9ca3af":"#16a34a",color:"white",border:"none",borderRadius:"4px",cursor:b?"not-allowed":"pointer",fontSize:"16px",fontWeight:"bold"},children:b?"Saving...":"Save Resume"})})]}):e.jsx("div",{style:{padding:"20px"},children:e.jsx("p",{children:"No resume data available."})})};T.createRoot(document.getElementById("root")).render(e.jsx(W.StrictMode,{children:e.jsx(N,{})}));
