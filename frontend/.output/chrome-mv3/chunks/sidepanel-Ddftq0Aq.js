import{a as Y,j as e,R as F,r as x}from"./client-DEd7WeES.js";const j="http://localhost:8080",S={async getUserResume(o){try{const d=await fetch(`${j}/api/resumes`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!d.ok)throw new Error(`Failed to fetch resumes: ${d.status}`);const l=(await d.json()).resumes;if(!l||l.length===0)return null;const f=l[0].id,c=await fetch(`${j}/api/resume/${f}`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}});if(!c.ok)throw new Error(`Failed to fetch resume: ${c.status}`);return await c.json()}catch(d){throw d}},async updateResume(o,d){const h=await fetch(`${j}/api/resume/parsed`,{method:"PATCH",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"},body:JSON.stringify({parsed_data:d})});if(!h.ok){const l=await h.json();throw new Error(l.error||"Failed to update resume")}}};async function k(){try{return(await chrome.storage.local.get(["auth_token"])).auth_token||null}catch(o){return console.error("Error getting auth token:",o),null}}const M=()=>{const[o,d]=x.useState(null),[h,l]=x.useState(null),[f,c]=x.useState(!0),[g,v]=x.useState(!1),[m,u]=x.useState(null),[C,n]=x.useState(!1);x.useEffect(()=>{(async()=>{try{const r=await k();if(!r){u("Not authenticated. Please log in."),c(!1);return}const i=await S.getUserResume(r);i?(l(i.id),d(i.parsed_data)):u("No resume found. Please upload a resume first.")}catch(r){u(r instanceof Error?r.message:"Failed to load resume")}finally{c(!1)}})()},[]);const s=(t,r)=>{o&&(d({...o,[t]:r}),n(!1))},B=(t,r)=>{if(!o)return;const i=[...o.skills];i[t]=r,d({...o,skills:i}),n(!1)},z=()=>{o&&(d({...o,skills:[...o.skills,""]}),n(!1))},R=t=>{o&&(d({...o,skills:o.skills.filter((r,i)=>i!==t)}),n(!1))},p=(t,r,i)=>{if(!o)return;const a=[...o.experience];a[t]={...a[t],[r]:i},d({...o,experience:a}),n(!1)},w=()=>{o&&(d({...o,experience:[...o.experience,{jobTitle:"",companyName:"",description:"",startMonth:"",startYear:"",endMonth:"",endYear:""}]}),n(!1))},E=t=>{o&&(d({...o,experience:o.experience.filter((r,i)=>i!==t)}),n(!1))},y=(t,r,i)=>{if(!o)return;const a=[...o.projects];a[t]={...a[t],[r]:i},d({...o,projects:a}),n(!1)},N=()=>{o&&(d({...o,projects:[...o.projects,{projectName:"",description:"",link:""}]}),n(!1))},W=t=>{o&&(d({...o,projects:o.projects.filter((r,i)=>i!==t)}),n(!1))},b=(t,r,i)=>{if(!o)return;const a=[...o.education];a[t]={...a[t],[r]:i},d({...o,education:a}),n(!1)},T=()=>{o&&(d({...o,education:[...o.education,{schoolName:"",fieldOfStudy:"",startYear:"",endYear:""}]}),n(!1))},A=t=>{o&&(d({...o,education:o.education.filter((r,i)=>i!==t)}),n(!1))},P=async()=>{if(o){v(!0),u(null),n(!1);try{const t=await k();if(!t){u("Not authenticated");return}await S.updateResume(t,o),n(!0)}catch(t){u(t instanceof Error?t.message:"Failed to save resume")}finally{v(!1)}}};return f?e.jsx("div",{style:{padding:"20px",textAlign:"center"},children:e.jsx("p",{children:"Loading resume..."})}):m&&!o?e.jsxs("div",{style:{padding:"20px"},children:[e.jsx("h2",{style:{color:"#dc2626",marginBottom:"10px"},children:"Error"}),e.jsx("p",{children:m})]}):o?e.jsxs("div",{style:{padding:"20px",fontFamily:"Arial, sans-serif",maxWidth:"800px"},children:[e.jsx("h1",{style:{marginBottom:"20px",fontSize:"24px"},children:"Edit Resume"}),m&&e.jsx("div",{style:{padding:"10px",backgroundColor:"#fee2e2",border:"1px solid #dc2626",borderRadius:"4px",marginBottom:"20px",color:"#dc2626"},children:m}),C&&e.jsx("div",{style:{padding:"10px",backgroundColor:"#dcfce7",border:"1px solid #16a34a",borderRadius:"4px",marginBottom:"20px",color:"#16a34a"},children:"Resume saved successfully!"}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Personal Information"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"First Name"}),e.jsx("input",{type:"text",value:o.firstName,onChange:t=>s("firstName",t.target.value),style:{width:"95%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Last Name"}),e.jsx("input",{type:"text",value:o.lastName,onChange:t=>s("lastName",t.target.value),style:{width:"95%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Email"}),e.jsx("input",{type:"email",value:o.email,onChange:t=>s("email",t.target.value),style:{width:"95%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Phone"}),e.jsx("input",{type:"tel",value:o.phone,onChange:t=>s("phone",t.target.value),style:{width:"95%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Country Code"}),e.jsx("input",{type:"text",value:o.countryCode,onChange:t=>s("countryCode",t.target.value),style:{width:"95%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Phone Number"}),e.jsx("input",{type:"tel",value:o.phoneNumber,onChange:t=>s("phoneNumber",t.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]})]})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Location"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Street Address"}),e.jsx("input",{type:"text",value:o.streetAddress,onChange:t=>s("streetAddress",t.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"City"}),e.jsx("input",{type:"text",value:o.city,onChange:t=>s("city",t.target.value),style:{width:"95%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Country"}),e.jsx("input",{type:"text",value:o.country,onChange:t=>s("country",t.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"bold",fontSize:"14px"},children:"Full Location"}),e.jsx("input",{type:"text",value:o.location,onChange:t=>s("location",t.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}})]})]})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Professional Summary"}),e.jsx("textarea",{value:o.professionalSummary,onChange:t=>s("professionalSummary",t.target.value),rows:4,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",fontFamily:"Arial, sans-serif"}})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Skills"}),o.skills.map((t,r)=>e.jsxs("div",{style:{display:"flex",gap:"10px",marginBottom:"10px"},children:[e.jsx("input",{type:"text",value:t,onChange:i=>B(r,i.target.value),style:{flex:1,padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px"}}),e.jsx("button",{onClick:()=>R(r),style:{padding:"8px 12px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px"},children:"Remove"})]},r)),e.jsx("button",{onClick:z,style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",marginTop:"10px"},children:"Add Skill"})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Experience"}),o.experience.map((t,r)=>e.jsxs("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#f9fafb",borderRadius:"4px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"10px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Job Title"}),e.jsx("input",{type:"text",value:t.jobTitle,onChange:i=>p(r,"jobTitle",i.target.value),style:{width:"90%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Company Name"}),e.jsx("input",{type:"text",value:t.companyName,onChange:i=>p(r,"companyName",i.target.value),style:{width:"85%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]})]}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Description"}),e.jsx("textarea",{value:t.description,onChange:i=>p(r,"description",i.target.value),rows:3,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px",fontFamily:"Arial, sans-serif"}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"10px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Start Month"}),e.jsx("input",{type:"text",value:t.startMonth,onChange:i=>p(r,"startMonth",i.target.value),style:{width:"90%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"End Month"}),e.jsx("input",{type:"text",value:t.endMonth,onChange:i=>p(r,"endMonth",i.target.value),style:{width:"90%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Start Year"}),e.jsx("input",{type:"text",value:t.startYear,onChange:i=>p(r,"startYear",i.target.value),style:{width:"85%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"End Year"}),e.jsx("input",{type:"text",value:t.endYear,onChange:i=>p(r,"endYear",i.target.value),style:{width:"85%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]})]}),e.jsx("button",{onClick:()=>E(r),style:{padding:"6px 12px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Remove Experience"})]},r)),e.jsx("button",{onClick:w,style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",marginTop:"10px"},children:"Add Experience"})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Projects"}),o.projects.map((t,r)=>e.jsxs("div",{style:{marginBottom:"15px",padding:"15px",backgroundColor:"#f9fafb",borderRadius:"4px"},children:[e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Project Name"}),e.jsx("input",{type:"text",value:t.projectName,onChange:i=>y(r,"projectName",i.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Description"}),e.jsx("textarea",{value:t.description,onChange:i=>y(r,"description",i.target.value),rows:3,style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px",fontFamily:"Arial, sans-serif"}})]}),e.jsxs("div",{style:{marginBottom:"10px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Link"}),e.jsx("input",{type:"text",value:t.link,onChange:i=>y(r,"link",i.target.value),style:{width:"100%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsx("button",{onClick:()=>W(r),style:{padding:"6px 12px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Remove Project"})]},r)),e.jsx("button",{onClick:N,style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",marginTop:"10px"},children:"Add Project"})]}),e.jsxs("section",{style:{marginBottom:"30px"},children:[e.jsx("h2",{style:{fontSize:"18px",marginBottom:"15px",borderBottom:"2px solid #e5e7eb",paddingBottom:"5px"},children:"Education"}),o.education.map((t,r)=>e.jsxs("div",{style:{marginBottom:"15px",padding:"15px",backgroundColor:"#f9fafb",borderRadius:"4px"},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"10px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"School Name"}),e.jsx("input",{type:"text",value:t.schoolName,onChange:i=>b(r,"schoolName",i.target.value),style:{width:"90%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Field of Study"}),e.jsx("input",{type:"text",value:t.fieldOfStudy,onChange:i=>b(r,"fieldOfStudy",i.target.value),style:{width:"90%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"10px",marginBottom:"10px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"Start Year"}),e.jsx("input",{type:"text",value:t.startYear,onChange:i=>b(r,"startYear",i.target.value),style:{width:"90%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontSize:"12px",fontWeight:"bold"},children:"End Year"}),e.jsx("input",{type:"text",value:t.endYear,onChange:i=>b(r,"endYear",i.target.value),style:{width:"90%",padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"12px"}})]})]}),e.jsx("button",{onClick:()=>A(r),style:{padding:"6px 12px",backgroundColor:"#dc2626",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"12px"},children:"Remove Education"})]},r)),e.jsx("button",{onClick:T,style:{padding:"8px 16px",backgroundColor:"#3b82f6",color:"white",border:"none",borderRadius:"4px",cursor:"pointer",fontSize:"14px",marginTop:"10px"},children:"Add Education"})]}),e.jsx("div",{style:{position:"sticky",bottom:"0",backgroundColor:"white",padding:"20px 0",borderTop:"2px solid #e5e7eb",marginTop:"20px"},children:e.jsx("button",{onClick:P,disabled:g,style:{width:"100%",padding:"12px",backgroundColor:g?"#9ca3af":"#16a34a",color:"white",border:"none",borderRadius:"4px",cursor:g?"not-allowed":"pointer",fontSize:"16px",fontWeight:"bold"},children:g?"Saving...":"Save Resume"})})]}):e.jsx("div",{style:{padding:"20px"},children:e.jsx("p",{children:"No resume data available."})})};Y.createRoot(document.getElementById("root")).render(e.jsx(F.StrictMode,{children:e.jsx(M,{})}));
